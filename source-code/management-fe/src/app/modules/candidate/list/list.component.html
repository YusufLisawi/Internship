<div class="content">
    <div class="row">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <h3>CANDIDATE</h3>
                </div>
                <hr>
                <div class="card-body">
                    <form novalidate #form="ngForm">
                        <div class="panel-heading">
                            <span class="input-group-btn float-right">
                                <button class="btn btn-default" title="Filter" (click)="isFilterOpen=!isFilterOpen"><i
                                        class="fa fa-filter"></i> Filter</button>&nbsp;
                                <button class="btn btn-default" title="Add Candidate" type="button" 
                                        (click)="openAddModal()"><i class="fa fa-plus"></i> Add Candidate</button>&nbsp;
                                <button class="btn btn-outline-p" title="Preselection" type="button"
                                        (click)="openPreselectionModal()"><i class="fas fa-check-circle"></i> Preselection</button>&nbsp;
                            </span>
                            

                            
                            <!-- table cand -->

                            <div id="myDIVCv" *ngIf="isFilterOpen" class="myDIV1">
                                <div class="form-row">
                                    <div class="col-4 custom-slider">
                                        <label class="mr-sm-2 label1" for="inlineFormCustomSelect">search by Name or Email</label>
                                        <input type="text" class="form-control search-field" placeholder="Search Here" [(ngModel)]="searchText">
                                    </div>
                                    <div class="col-4">
                                        <label class="mr-sm-2 label1" for="inlineFormCustomSelect">Level of studies</label>
                                        <select class="custom-select mr-sm-2 form-select1" name="levelOfStudy" [(ngModel)]="levelOfStudy">
                                            <option></option>
                                            <option *ngFor="let level of lvls" [value]="level">{{level}}</option>
                                        </select>
                                    </div>
                                    <div class="col-4">
                                        <label class="mr-sm-2 label1" for="inlineFormCustomSelect">University</label>
                                        <select class="custom-select mr-sm-2 form-select1" name="university" [(ngModel)]="university">
                                            <option selected></option>
                                            <option *ngFor="let university of universities" [value]="university">{{university}}</option>
                                        </select>
                                    </div>
                                    <div class="col-4">
                                        <label class="mr-sm-2 label1" for="inlineFormCustomSelect">City</label>
                                        <select class="custom-select mr-sm-2 form-select1" name="city" [(ngModel)]="city">
                                            <option selected></option>
                                            <option *ngFor="let city of cities" [value]="city">{{city}}</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <br /><br />
                    </form>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead>
                                <th scope="col" (click)="changeOrder('Preselection')"></th>
                                <th scope="col" (click)="changeOrder('fName')">First name</th>
                                <th scope="col" (click)="changeOrder('lName')">Last name</th>
                                <th scope="col" (click)="changeOrder('email')">Email</th>
                                <th scope="col">Phone</th>
                                <th scope="col" (click)="changeOrder('levelOfStudy')">Diploma</th>
                                <th scope="col" (click)="changeOrder('city')">City</th>
                                <th scope="col" (click)="changeOrder('university')">University</th>
                                <th scope="col" class="text-center" >Actions</th>
                            </thead>

                            <tbody>
                                <tr *ngFor="let user of (candidatesFiltered | searchFilter: searchText : levelOfStudy : university : city : isFilterOpen) | tableFilter: orderBy :asc ">
                                    <td [ngClass]="user?.preselectionStatus==true ? 'bg-success' : user?.preselectionStatus==false && 'bg-danger'"></td>
                                    <td>{{ user?.firstName }}</td>
                                    <td>{{ user?.lastName }}</td>
                                    <td>{{ user?.email }}</td>
                                    <td>{{ user?.phoneNumber }}</td>
                                    <td>{{ user?.diplome }}</td>
                                    <td>{{ user?.city }}</td>
                                    <td>{{ user?.university }}</td>
                                    <td class="text-center">
                                        <a data-tip="Accept" title="Accept"><i class="fas fa-check-circle cvYes pointer" (click)="setPreselectionStatus(user?.candidateId, true)"></i></a>
                                        <a data-tip="Reject" title="Reject"><i class="fa fa-times-circle cvNo pointer" aria-hidden="true" (click)="setPreselectionStatus(user?.candidateId, false)"></i></a>
                                        <a *ngIf="user?.cvname" data-tip="Download" href="{{backUrl}}file/find/{{user?.cvname}}" download="{{user?.cvname}}" class="aMargin pointer" title="Download CV"><i class="fas fa-arrow-circle-down"></i></a>
                                        <i *ngIf="!user?.cvname" class="fas fa-arrow-circle-down aMargin disabled"></i>
                                        <a data-tip="edit" class="aMargin pointer" title="Edit"><i class="fa fa-edit" (click)="openUpdateModal(user?.candidateId)"></i></a>
                                        <a data-tip="delete" class="aMargin pointer" title="Delete" *hasRole="['ROLE_ADMIN']"><i class="fa fa-trash" (click)="deleteCandidate(user.candidateId)"></i></a>
                                    </td>
                                </tr>
                            </tbody>

                        </table>

                    </div>
                    <div class="d-flex justify-content-between p-2">
                        <ngb-pagination [collectionSize]="collectionSize" [(page)]="page" [pageSize]="pageSize"
                            (pageChange)="refreshCandidates()">
                        </ngb-pagination>

                        <select class="form-select select1" [(ngModel)]="pageSize" (ngModelChange)="refreshCandidates()">
                            <option [ngValue]="15">15 Items</option>
                            <option [ngValue]="20">20 Items</option>
                            <option [ngValue]="50">50 Items</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

